<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汽车电气系统PDF搜索系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: "Microsoft YaHei", Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1400px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 30px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header h1 { color: #2c3e50; margin: 0; }
        .header p { color: #7f8c8d; margin: 10px 0 0; }

        .upload-area { background: white; padding: 25px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .upload-area h3 { color: #2c3e50; margin-top: 0; display: flex; align-items: center; gap: 10px; }
        .upload-form { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
        .file-input { padding: 8px; border: 1px solid #ddd; border-radius: 4px; flex: 1; max-width: 500px; }
        .upload-btn { padding: 10px 25px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; display: flex; align-items: center; gap: 8px; transition: background 0.3s; }
        .upload-btn:hover { background: #2980b9; }

        .pdf-list-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .pdf-list-header h2 { color: #2c3e50; margin: 0; }
        .status-legend { display: flex; gap: 15px; font-size: 0.9em; }
        .legend-item { display: flex; align-items: center; gap: 5px; }
        .legend-dot { width: 12px; height: 12px; border-radius: 50%; }

        .pdf-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 20px; }
        .pdf-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); transition: transform 0.2s, box-shadow 0.2s; position: relative; }
        .pdf-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        /* 特定PDF标记 */
        .special-badge { position: absolute; top: 15px; right: 15px; background: #e74c3c; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.8em; font-weight: 500; }

        .card-header { margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .card-title { font-size: 16px; margin: 0; color: #2c3e50; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; height: 44px; }
        .card-short-name { color: #7f8c8d; font-size: 0.9em; margin-top: 5px; }

        .card-meta { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 15px; font-size: 0.9em; }
        .meta-item { display: flex; align-items: center; gap: 5px; color: #34495e; }
        .meta-item i { color: #3498db; width: 16px; text-align: center; }

        .card-status { display: flex; align-items: center; gap: 5px; margin-bottom: 15px; font-size: 0.9em; }
        .status { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.9em; font-weight: 500; }
        .status-untreated { background: #fff3e0; color: #f57c00; }
        .status-processing { background: #e3f2fd; color: #1976d2; }
        .status-success { background: #e8f5e9; color: #388e3c; }
        .status-special { background: #fce4ec; color: #c2185b; }
        .status-failed { background: #ffebee; color: #d32f2f; }

        .btn-group { display: flex; gap: 10px; }
        .btn { padding: 9px 15px; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9em; text-decoration: none; display: flex; align-items: center; gap: 6px; transition: background 0.3s; }
        .btn-view { background: #2ecc71; color: white; flex: 1; justify-content: center; }
        .btn-view:hover { background: #27ae60; }
        .btn-process { background: #f39c12; color: white; flex: 1; justify-content: center; }
        .btn-process:disabled { background: #ccc; cursor: not-allowed; opacity: 0.7; }
        .btn-process:hover:not(:disabled) { background: #e67e22; }

        @media (max-width: 768px) {
            .pdf-list { grid-template-columns: 1fr; }
            .upload-form { flex-direction: column; align-items: stretch; }
            .status-legend { display: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-car-battery"></i> 汽车电气系统PDF搜索系统</h1>
            <p>上传、处理汽车电气原理图PDF，精准搜索元器件位置</p>
        </div>

        <div class="upload-area">
            <h3><i class="fas fa-upload"></i> 上传PDF文件</h3>
            <form class="upload-form" action="/upload" method="post" enctype="multipart/form-data">
                <input type="file" name="pdf_file" accept=".pdf" class="file-input" required>
                <button type="submit" class="upload-btn">
                    <i class="fas fa-cogs"></i> 上传并自动处理
                </button>
            </form>
        </div>

        <div class="pdf-list-header">
            <h2><i class="fas fa-file-pdf"></i> 已上传PDF列表</h2>
            <div class="status-legend">
                <div class="legend-item">
                    <span class="legend-dot" style="background: #388e3c;"></span>
                    <span>已处理</span>
                </div>

                </div>
                <div class="legend-item">
                    <span class="legend-dot" style="background: #1976d2;"></span>
                    <span>处理中</span>
                </div>
                <div class="legend-item">
                    <span class="legend-dot" style="background: #f57c00;"></span>
                    <span>未处理</span>
                </div>
                <div class="legend-item">
                    <span class="legend-dot" style="background: #d32f2f;"></span>
                    <span>处理异常</span>
                </div>
            </div>
        </div>

        <div class="pdf-list">
            {% if pdf_list %}
                {% for pdf in pdf_list %}
                <div class="pdf-card">
                    {% if pdf.is_special %}

                    {% endif %}

                    <div class="card-header">
                        <h3 class="card-title">{{ pdf.filename }}</h3>
                        {% if pdf.filename != pdf.short_filename %}
                            <div class="card-short-name">{{ pdf.short_filename }}</div>
                        {% endif %}
                    </div>

                    <div class="card-meta">
                        <div class="meta-item"><i class="fas fa-file-size"></i> 大小：{{ pdf.size_mb }} MB</div>
                        <div class="meta-item"><i class="fas fa-file-alt"></i> 页数：{{ pdf.total_pages }}</div>
                        <div class="meta-item"><i class="fas fa-microchip"></i> 元器件：{{ pdf.total_components }} 个</div>
                        <div class="meta-item"><i class="fas fa-clock"></i> 处理时间：{{ pdf.processed_time }}</div>
                    </div>

                    <div class="card-status">
                        <i class="fas fa-info-circle"></i>
                        {% if pdf.status == "未处理" %}
                            <span class="status status-untreated">{{ pdf.status }}</span>
                        {% elif pdf.status == "处理中" %}
                            <span class="status status-processing">{{ pdf.status }}</span>
                        {% elif pdf.status == "已处理" %}
                            <span class="status status-success">{{ pdf.status }}</span>
                        {% elif pdf.status == "已处理（预定义）" %}
                            <span class="status status-special">{{ pdf.status }}</span>
                        {% else %}
                            <span class="status status-failed">{{ pdf.status }}</span>
                        {% endif %}
                    </div>

                    <div class="btn-group">
                        <a href="{{ url_for('view_pdf', pdf_filename=pdf.filename) }}" class="btn btn-view">
                            <i class="fas fa-search"></i> 查看与搜索
                        </a>
                        <a href="{{ url_for('process_pdf', pdf_filename=pdf.filename) }}" class="btn btn-process"
                           {% if pdf.status in ["处理中", "已处理", "已处理（预定义）"] %}disabled{% endif %}>
                            <i class="fas fa-refresh"></i> {% if pdf.status == "未处理" %}处理PDF{% else %}重新处理{% endif %}
                        </a>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div style="grid-column: 1 / -1; padding: 50px; text-align: center; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <i class="fas fa-file-pdf" style="font-size: 48px; color: #d32f2f; margin-bottom: 20px;"></i>
                    <h3 style="color: #7f8c8d; margin: 0;">暂无上传的PDF文件</h3>
                    <p style="color: #95a5a6; margin-top: 10px;">请使用上方上传区域上传汽车电气系统PDF文件</p>
                </div>
            {% endif %}
        </div>
    </div>
</body>
</html>
